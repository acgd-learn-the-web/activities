var ActivityRunner=function(){"use strict";var e={start:null},t={},n={failure:document.querySelectorAll('[data-screen="failure"] p'),success:document.querySelectorAll('[data-screen="success"] p')},o=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},c=function(e){for(;e.match(/`/);)e=e.replace(/`/,"<code>"),e=e.replace(/`/,"</code>");return e},r=function(){var e=document.querySelectorAll("[data-screen]"),n=0,o=e.length;for(n;o>n;n++)t[e[n].getAttribute("data-screen")]=e[n]},i=function(e){t[e].hidden?t[e].hidden=!1:t[e].hidden=!0},u=function(e,t){i(e),setTimeout(function(){var n=e,o=t;i(n),document.querySelector("main h2").focus(),o&&o()},700)},s=function(e){var t=0,n=e.length,o=Math.floor(Math.random()*n);for(t;n>t;t++)e[t].hidden=!0;e[o].hidden=!1},a=function(e){u("success",e),s(n.success),t.success.focus()},d=function(e){u("failure",e),s(n.failure),t.failure.focus()},l=function(e){i("main"),g("end"),i("end"),document.querySelector('[data-screen="end"] > h2').focus()},f=function(e,t){i("main"),g("fatal-error"),i("fatal-error"),document.getElementById("fatal-error-img").src=t.image,document.getElementById("fatal-error-message").innerHTML=o(t.message),document.querySelector('[data-screen="fatal-error"] > h2').focus()},m=function(e,t,n){switch(e){case"success":a(t);break;case"failure":d(t);break;case"end":l(t);break;case"fatal-error":f(t,n)}},h=function(t,n){e[t]||(e[t]=[]),e[t].push(n)},g=function(t){e[t]&&e[t].forEach(function(e){e()})},p=function(){var e=document.getElementById("start-button");e&&e.addEventListener("click",function(){v()})},v=function(){i("start"),i("main"),document.querySelector("main h2").focus(),g("start")};return r(),p(),{escape:o,convertToCode:c,toggleScreen:i,send:m,listen:h,start:v}},CodeCompare=function(e,t){"use strict";var n=null,o=0,c={title:document.getElementById("question-title"),form:document.getElementById("question-form")},r=function(){n=ace.edit("editor"),n.setTheme("ace/theme/idle_fingers"),n.getSession().setMode("ace/mode/html"),n.getSession().setUseSoftTabs(!0),n.getSession().setTabSize(2),n.getSession().setUseWrapMode(!1),n.setHighlightActiveLine(!0),n.setDisplayIndentGuides(!0),n.setShowInvisibles(!0),n.setShowPrintMargin(!1),n.setShowFoldWidgets(!1),n.getSession().setOption("useWorker",!1)},i=function(){c.form.addEventListener("submit",function(e){e.preventDefault(),d()})},u=function(){return!(o==t.length-1)},s=function(o){c.title.innerHTML=e.convertToCode(e.escape(t[o].question)),n.setValue(t[o].incorrect),n.navigateFileStart(),n.focus()},a=function(){u()?(o++,s(o)):e.send("end")},d=function(){switch(l()){case"yes":e.send("success",function(){a()});break;case"no":e.send("failure",function(){n.focus()});break;default:e.send("failure",function(){n.focus()})}},l=function(){var e="yes";switch(typeof t[o].correct){case"string":n.getValue()!==t[o].correct&&(e="no");break;case"function":t[o].correct(n.getValue())||(e="no");break;default:e="no"}return e};r(),i(),e.listen("start",function(){s(o)})},FormValidator=function(e,t){"use strict";var n=0,o={title:document.getElementById("question-title"),inputs:document.getElementById("question-inputs"),form:document.getElementById("question-form")},c={},r=function(){o.form.addEventListener("submit",function(e){e.preventDefault(),d()})},i=function(){var e=document.querySelectorAll("[data-input-group]"),t=0,n=e.length;for(t;n>t;t++)c[e[t].getAttribute("data-input-group")]=e[t],e[t].parentNode.removeChild(e[t])},u=function(){return!(n==t.length-1)},s=function(n){o.title.innerHTML=e.convertToCode(e.escape(t[n].question)),o.inputs.innerHTML="",o.inputs.appendChild(c[t[n].inputGroup]),t[n].onStart&&t[n].onStart()},a=function(){u()?(n++,s(n)):e.send("end")},d=function(t){var n=t||l();switch(n){case"yes":e.send("success",function(){a()});break;case"no":e.send("failure");break;default:e.send("failure")}},l=function(){var e="yes";return Object.keys(t[n].inputs).forEach(function(o){var c=document.getElementById(o),r=t[n].inputs[o];switch(typeof r){case"string":case"number":c.value.trim()!=r&&(e="no");break;case"boolean":c.checked||(e="no");break;case"function":r(c.value)||(e="no");break;case"object":c.value.trim().match(r)||(e="no");break;default:e="no"}}),e};return r(),i(),e.listen("start",function(){s(n)}),{runner:e,advanceOrFail:d}},MultipleChoice=function(e,t){"use strict";var n=0,o={title:document.getElementById("question-title"),choices:document.getElementById("question-choices"),form:document.getElementById("question-form"),extras:document.getElementById("extras")},c=function(){o.form.addEventListener("submit",function(e){e.preventDefault(),a()})},r=function(){return!(n==t.length-1)},i=function(t,n){var o,c,r;return o=document.createElement("li"),c=document.createElement("input"),c.setAttribute("type","radio"),c.setAttribute("name","question-choices"),c.id="choice-"+t,c.setAttribute("data-id",t),o.appendChild(c),r=document.createElement("label"),r.setAttribute("for","choice-"+t),r.innerHTML=e.convertToCode(e.escape(n)),o.appendChild(r),o},u=function(n){var c=0,r=t[n].choices.length;for(o.choices.innerHTML="",o.title.innerHTML=e.convertToCode(e.escape(t[n].question)),t[n].extras?o.extras.innerHTML=document.getElementById(t[n].extras).innerHTML:o.extras.innerHTML="",c;r>c;c++)o.choices.appendChild(i(c,t[n].choices[c]))},s=function(){r()?(n++,u(n)):e.send("end")},a=function(){switch(d()){case"yes":e.send("success",function(){s()});break;case"no":e.send("failure");break;default:e.send("failure")}},d=function(){var e=o.choices.querySelector(":checked");if(e)return parseInt(e.getAttribute("data-id"),10)==t[n].correct?"yes":"no"};c(),e.listen("start",function(){u(n)})},TimedCallback=function(e,t){"use strict";var n,o,c=0,r=15,i={title:document.getElementById("question-title"),contents:document.getElementById("question-contents")},u={},s=function(e){r=e},a=function(e){n=e},d=function(){clearInterval(o)},l=function(){o=setTimeout(function(){p()},r)},f=function(){var e=document.querySelectorAll("[data-content-group]"),t=0,n=e.length;for(t;n>t;t++)u[e[t].getAttribute("data-content-group")]=e[t],e[t].parentNode.removeChild(e[t])},m=function(){return!(c==t.length-1)},h=function(n){i.title.innerHTML=e.convertToCode(e.escape(t[n].question)),i.contents.innerHTML="",i.contents.appendChild(u[t[n].contentGroup]),t[n].onStart&&t[n].onStart()},g=function(){m()?(c++,h(c),l()):e.send("end")},p=function(){switch(d(),v()){case"yes":e.send("success",function(){g()});break;case"no":e.send("failure",function(){l()});break;default:l()}},v=function(){var e=t[c].onTick();return e===!0?"yes":e===!1?"no":void 0};return e.listen("start",function(){n&&n(),f(),h(c),l()}),{setTickTime:s,startTicker:l,stopTicker:d,setStartHandler:a,runner:e}};